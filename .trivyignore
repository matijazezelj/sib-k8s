# SIB-K8s Trivy Ignore File
# This file documents security findings that cannot be fixed due to architectural requirements.
# Each entry includes an explanation of why the finding is acceptable.

# =============================================================================
# K8saudit Deployment - Required for Kubernetes API Server Webhook Integration
# =============================================================================

# AVD-KSV-0009: hostNetwork is required for the k8saudit webhook receiver.
# The Kubernetes API server runs on the host network and needs direct access
# to the Falco k8saudit plugin to send audit webhook events.
AVD-KSV-0009

# AVD-KSV-0024: hostPort is required for the k8saudit webhook receiver.
# The API server must be able to reach the webhook endpoint on a known port
# on the node's network interface.
AVD-KSV-0024

# =============================================================================
# Untrusted Registry Warnings - Using Official Container Registries
# =============================================================================

# AVD-KSV-0125: Images are pulled from official, trusted registries:
# - docker.io/falcosecurity/* - Official Falco images
# - docker.io/grafana/* - Official Grafana images
# - ghcr.io/* - GitHub Container Registry (used for sib-k8s-analyzer)
# These are legitimate, well-maintained registries. The "untrusted" warning
# is because Trivy's default trusted list is very restrictive.
AVD-KSV-0125

# =============================================================================
# Image Tag Warnings - Design Choice
# =============================================================================

# AVD-KSV-0013: The analysis service uses :latest tag by default.
# This is configurable via Helm values (.Values.analysis.image.tag).
# Users should set a specific version tag in production deployments.
AVD-KSV-0013

# =============================================================================
# Default Namespace Warning - Handled by Helm
# =============================================================================

# AVD-KSV-0110: Trivy scans templates without Helm context.
# The actual namespace is set during `helm install -n <namespace>`.
# All resources will be deployed to the user-specified namespace.
AVD-KSV-0110

# =============================================================================
# ConfigMap Sensitive Content - False Positives
# =============================================================================

# AVD-KSV-01010: These are configuration values, not sensitive secrets.
# Items like CACHE_TTL, PORT, OLLAMA_TIMEOUT are operational settings.
# Actual secrets (API keys) are stored in Kubernetes Secrets, not ConfigMaps.
AVD-KSV-01010

# =============================================================================
# Falco DaemonSet - Required for Syscall Monitoring
# =============================================================================

# AVD-KSV-0017: Falco requires privileged mode for syscall monitoring.
# The eBPF/kernel module driver needs elevated privileges to attach probes
# to the kernel for detecting security-relevant syscalls.
AVD-KSV-0017

# AVD-KSV-0121: Falco requires hostPath volumes for syscall monitoring.
# Mounts like /proc, /boot, /etc, /usr are needed to:
# - Read kernel symbols and configuration
# - Access process information
# - Load eBPF programs
AVD-KSV-0121

# AVD-KSV-0118: Falco daemonset uses default security context by design.
# Syscall monitoring requires root privileges and access to host resources.
# This is an expected requirement for runtime security tools.
AVD-KSV-0118

# =============================================================================
# Helm Test Pods - Non-Production Resources
# =============================================================================

# AVD-KSV-0014, AVD-KSV-0118: Helm test pods (*-test, *-test-connection)
# These are temporary pods used only during `helm test` for validation.
# They are not deployed in normal operation and have minimal security impact.
# Affected: test-falcosidekick-test-connection, test-grafana-test, loki-helm-test
AVD-KSV-0014

# =============================================================================
# Upstream Chart Init Containers - Cannot Override
# =============================================================================

# init-chown-data (Grafana), loki-sc-rules (Loki):
# These init containers in upstream charts don't expose security context
# configuration options. They run briefly during startup to set permissions.
# Risk is mitigated by:
# - Short execution time (init only)
# - Limited scope (file permission changes)
# - Upstream chart maintainer responsibility

# =============================================================================
# Loki ClusterRole - Upstream Chart Design
# =============================================================================

# AVD-KSV-0041: Loki ClusterRole has secrets access for service discovery.
# This is required by Loki's memberlist/ring functionality to discover
# other Loki instances in distributed mode. In SingleBinary mode (our default),
# this permission is less critical but still created by the upstream chart.
AVD-KSV-0041
